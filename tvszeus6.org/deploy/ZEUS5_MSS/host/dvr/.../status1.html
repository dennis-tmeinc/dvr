<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta content="text/html; charset=UTF-8" http-equiv="content-type" />
<meta content="Dennis Chen" name="author" />
<link href="eagle.css" rel="stylesheet" type="text/css" /><title>Status</title>
<script type="text/javascript" src="eagle.js"></script>
</head>
<body>
<!--#include file="header.i"-->
<div class="tabs">
<ul>
<li><a onclick="on_system_click()"><span>System</span></a></li>
<li><a onclick="on_camera_click()"><span>Camera</span></a></li>
<li><a onclick="on_sensor_click()"><span>Sensor</span></a></li>
<li><a onclick="on_network_click()"><span>Network</span></a></li>
<li class="current"><a onclick="on_status_click()"><span>Status</span></a></li>
<li><a onclick="on_tools_click()"><span>Tools</span></a></li>
</ul>
</div>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<td class="col1">Firmware Version:</td>
<td> <!--#include file="firmware_version"--> </td>
</tr>
<tr>
<td class="col1">MCU Firmware Version:</td>
<td> <!--#include file="/var/dvr/mcuversion"--> </td>
</tr>
<tr>
<td class="col1">Camera Number:</td>
<td> <!--#include cameranumber="camera_number" --> </td>
</tr>
<tr>
<td class="col1">Sensor Number:</td>
<td> <!--#include sensornumber="sensor_number" --> </td>
</tr>
<tr>
<td class="col1">Alarm Number:</td>
<td> <!--#include lednumber="led_number" --></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td class="col1">DVR Time:</td>
<td><span id="id_dvr_time"> </span>
</td>
</tr>
<tr>
<td class="col1">Computer Time:</td>
<td><span id="id_local_time"> </span></td>
</tr>
<tr>
<td></td>
<td>
<form id="dvrsetup" enctype="application/x-www-form-urlencoded" method="post" action="status.html">
 <input name="page" value="status" type="hidden" />
 <input name="dvrtime", id="id_dvrtime" value="0" type="hidden" />
 <input name="synctime", id="id_synctime" value="0" type="hidden" />
 <input onclick="on_sync_time()" value="Synchronize DVR Time" type="button" />
</form>
</td>
</tr>
<tr>
<td>&nbsp;</td>
<td><br />
</td>
</tr>
<form id="dvrstatus">
<script type="text/javascript">
var camera_num = <!--#include cameranumber="camera_number" --> ;
for( i=1; i<=camera_num; i++ ) {
var name ;
document.write( "<tr><td class=\"col1\">Camera "+i+" Status:</td>" );
name = "camera_"+i+"_signal_lost" ;
document.write( "<td><input name=\""+name+"\" type=\"checkbox\" />Signal Lost " );
name = "camera_"+i+"_recording" ;
document.write( "<input name=\""+name+"\" type=\"checkbox\" >Recording " ); 
name = "camera_"+i+"_motion" ;
document.write( "<input name=\""+name+"\" type=\"checkbox\" />Motion</td></tr>" );
}
</script>
</form>
<tr>
<td>&nbsp;</td>
<td></td>
</tr>
</tbody>
</table>
<script type="text/javascript">
var count=1 ;
var timer ;
var t=new Date();

var odvrtime=Date.parse( document.getElementById("id_dvrtime").value );

function statusvalue( statusvalue )
{
    var sval ;
    document.getElementById("dvrstatus").reset();
    eval("sval = new Array( " + statusvalue + " 0 );") ;
    initfield( sval );
    count=1 ;
    t=new Date();
    odvrtime=Date.parse( document.getElementById("id_dvrtime").value );
    timer=setTimeout("timefunc()", 300);
}

var xmlhttp;
function loadXMLDoc(url)
{
  xmlhttp=null;
  if (window.XMLHttpRequest)
   {    // code for Firefox, Opera, IE7, etc.
    xmlhttp=new XMLHttpRequest();
   }
else if (window.ActiveXObject)
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
if (xmlhttp!=null)
  {
  xmlhttp.onreadystatechange=state_Change;
  xmlhttp.open("GET",url,true);
  xmlhttp.send(null);
  }
else
  {
  alert("Your browser does not support XMLHTTP.");
  }
}

function state_Change()
{
if (xmlhttp.readyState==4)
  {// 4 = "loaded"
  if (xmlhttp.status==200)
    {// 200 = "OK"
      statusvalue( xmlhttp.responseText ) ;
    }
  else
    {
    alert("Problem retrieving data:" + xmlhttp.statusText);
    }
  }
}

function timefunc()
{
    t1 = new Date();
    var diff = t1.getTime() - t.getTime();
    t2 = new Date();
    t2.setTime( odvrtime+diff );
    
    document.getElementById("id_dvr_time").innerHTML=t2.toLocaleDateString()+" "
                                                     +t2.toLocaleTimeString() + " " 
                                                     +"(<!--#include file="timezone"-->)" ;
    document.getElementById("id_local_time").innerHTML=t1.toLocaleDateString()+" "+t1.toLocaleTimeString();
    count=count+1 ;
    if( count%50 == 0 ) {
        loadXMLDoc( "status_value" ) ;
//         window.location.assign("status.html");
    }
    else {
        timer=setTimeout("timefunc()", 200);
    }

}

timer=setTimeout("timefunc()", 1 );


</script>
</body></html>
